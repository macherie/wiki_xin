a:207:{i:0;a:3:{i:0;s:14:"document_start";i:1;a:0:{}i:2;i:0;}i:1;a:3:{i:0;s:6:"header";i:1;a:3:{i:0;s:14:"sepolicy规则";i:1;i:2;i:2;i:1;}i:2;i:1;}i:2;a:3:{i:0;s:12:"section_open";i:1;a:1:{i:0;i:2;}i:2;i:1;}i:3;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:1;}i:4;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:22:"selunx,seandroid规则";}i:2;i:26;}i:5;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:48;}i:6;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:48;}i:7;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:34:"较详细的规则可以查看：
";}i:2;i:50;}i:8;a:3:{i:0;s:12:"internallink";i:1;a:2:{i:0;s:66:"172.21.1.23/dokuwiki/doku.php?id=linux:selinux:selinux添加策略";i:1;N;}i:2;i:84;}i:9;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:154;}i:10;a:3:{i:0;s:13:"section_close";i:1;a:0:{}i:2;i:156;}i:11;a:3:{i:0;s:6:"header";i:1;a:3:{i:0;s:21:"1. 节点访问权限";i:1;i:3;i:2;i:156;}i:2;i:156;}i:12;a:3:{i:0;s:12:"section_open";i:1;a:1:{i:0;i:3;}i:2;i:156;}i:13;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:156;}i:14;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:124:"<5>[77037.274119] [(2015-01-20 09:17:42.876329323 UTC)] [cpuid: 2] type=1400 audit(1421745462.859:2172964): avc:  denied  { ";}i:2;i:187;}i:15;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:1;i:1;a:2:{i:0;s:5:"green";i:1;s:0:"";}}i:2;i:1;i:3;s:13:"<color green>";}i:2;i:311;}i:16;a:3:{i:0;s:11:"strong_open";i:1;a:0:{}i:2;i:324;}i:17;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:5:"write";}i:2;i:326;}i:18;a:3:{i:0;s:12:"strong_close";i:1;a:0:{}i:2;i:331;}i:19;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:4;i:1;s:0:"";}i:2;i:4;i:3;s:8:"</color>";}i:2;i:333;}i:20;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:17:" } for  pid=15848";}i:2;i:341;}i:21;a:3:{i:0;s:9:"linebreak";i:1;a:0:{}i:2;i:358;}i:22;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:6:"
comm=";}i:2;i:360;}i:23;a:3:{i:0;s:18:"doublequoteopening";i:1;a:0:{}i:2;i:366;}i:24;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:13:"system_server";}i:2;i:367;}i:25;a:3:{i:0;s:18:"doublequoteclosing";i:1;a:0:{}i:2;i:380;}i:26;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:6:" name=";}i:2;i:381;}i:27;a:3:{i:0;s:18:"doublequoteopening";i:1;a:0:{}i:2;i:387;}i:28;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:6:"enable";}i:2;i:388;}i:29;a:3:{i:0;s:18:"doublequoteclosing";i:1;a:0:{}i:2;i:394;}i:30;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:5:" dev=";}i:2;i:395;}i:31;a:3:{i:0;s:18:"doublequoteopening";i:1;a:0:{}i:2;i:400;}i:32;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:5:"sysfs";}i:2;i:401;}i:33;a:3:{i:0;s:18:"doublequoteclosing";i:1;a:0:{}i:2;i:406;}i:34;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:23:" ino=9381 scontext=u:r:";}i:2;i:407;}i:35;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:1;i:1;a:2:{i:0;s:4:"blue";i:1;s:0:"";}}i:2;i:1;i:3;s:12:"<color blue>";}i:2;i:430;}i:36;a:3:{i:0;s:11:"strong_open";i:1;a:0:{}i:2;i:442;}i:37;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:6:"zygote";}i:2;i:444;}i:38;a:3:{i:0;s:12:"strong_close";i:1;a:0:{}i:2;i:450;}i:39;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:4;i:1;s:0:"";}i:2;i:4;i:3;s:8:"</color>";}i:2;i:452;}i:40;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:24:":s0 tcontext=u:object_r:";}i:2;i:460;}i:41;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:1;i:1;a:2:{i:0;s:3:"red";i:1;s:0:"";}}i:2;i:1;i:3;s:11:"<color red>";}i:2;i:484;}i:42;a:3:{i:0;s:11:"strong_open";i:1;a:0:{}i:2;i:495;}i:43;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:5:"sysfs";}i:2;i:497;}i:44;a:3:{i:0;s:12:"strong_close";i:1;a:0:{}i:2;i:502;}i:45;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:4;i:1;s:0:"";}i:2;i:4;i:3;s:8:"</color>";}i:2;i:504;}i:46;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:11:":s0 tclass=";}i:2;i:512;}i:47;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:1;i:1;a:2:{i:0;s:7:"fuchsia";i:1;s:0:"";}}i:2;i:1;i:3;s:15:"<color fuchsia>";}i:2;i:523;}i:48;a:3:{i:0;s:11:"strong_open";i:1;a:0:{}i:2;i:538;}i:49;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:4:"file";}i:2;i:540;}i:50;a:3:{i:0;s:12:"strong_close";i:1;a:0:{}i:2;i:544;}i:51;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:4;i:1;s:0:"";}i:2;i:4;i:3;s:8:"</color>";}i:2;i:546;}i:52;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:554;}i:53;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:554;}i:54;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:124:"<5>[77037.841329] [(2015-01-20 09:17:43.443539322 UTC)] [cpuid: 0] type=1400 audit(1421745463.429:2172966): avc:  denied  { ";}i:2;i:556;}i:55;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:1;i:1;a:2:{i:0;s:5:"green";i:1;s:0:"";}}i:2;i:1;i:3;s:13:"<color green>";}i:2;i:680;}i:56;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:3;i:1;s:4:"open";}i:2;i:3;i:3;s:4:"open";}i:2;i:693;}i:57;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:4;i:1;s:0:"";}i:2;i:4;i:3;s:8:"</color>";}i:2;i:697;}i:58;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:17:" } for  pid=15871";}i:2;i:705;}i:59;a:3:{i:0;s:9:"linebreak";i:1;a:0:{}i:2;i:722;}i:60;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:6:"
comm=";}i:2;i:724;}i:61;a:3:{i:0;s:18:"doublequoteopening";i:1;a:0:{}i:2;i:730;}i:62;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:15:"ActivityManager";}i:2;i:731;}i:63;a:3:{i:0;s:18:"doublequoteclosing";i:1;a:0:{}i:2;i:746;}i:64;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:6:" name=";}i:2;i:747;}i:65;a:3:{i:0;s:18:"doublequoteopening";i:1;a:0:{}i:2;i:753;}i:66;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:4:"stat";}i:2;i:754;}i:67;a:3:{i:0;s:18:"doublequoteclosing";i:1;a:0:{}i:2;i:758;}i:68;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:5:" dev=";}i:2;i:759;}i:69;a:3:{i:0;s:18:"doublequoteopening";i:1;a:0:{}i:2;i:764;}i:70;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:4:"proc";}i:2;i:765;}i:71;a:3:{i:0;s:18:"doublequoteclosing";i:1;a:0:{}i:2;i:769;}i:72;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:23:" ino=5513 scontext=u:r:";}i:2;i:770;}i:73;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:1;i:1;a:2:{i:0;s:4:"blue";i:1;s:0:"";}}i:2;i:1;i:3;s:12:"<color blue>";}i:2;i:793;}i:74;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:3;i:1;s:6:"zygote";}i:2;i:3;i:3;s:6:"zygote";}i:2;i:805;}i:75;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:4;i:1;s:0:"";}i:2;i:4;i:3;s:8:"</color>";}i:2;i:811;}i:76;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:17:":s0 tcontext=u:r:";}i:2;i:819;}i:77;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:1;i:1;a:2:{i:0;s:3:"red";i:1;s:0:"";}}i:2;i:1;i:3;s:11:"<color red>";}i:2;i:836;}i:78;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:3;i:1;s:4:"init";}i:2;i:3;i:3;s:4:"init";}i:2;i:847;}i:79;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:4;i:1;s:0:"";}i:2;i:4;i:3;s:8:"</color>";}i:2;i:851;}i:80;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:11:":s0 tclass=";}i:2;i:859;}i:81;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:1;i:1;a:2:{i:0;s:7:"fuchsia";i:1;s:0:"";}}i:2;i:1;i:3;s:15:"<color fuchsia>";}i:2;i:870;}i:82;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:3;i:1;s:4:"file";}i:2;i:3;i:3;s:4:"file";}i:2;i:885;}i:83;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:4;i:1;s:0:"";}i:2;i:4;i:3;s:8:"</color>";}i:2;i:889;}i:84;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:897;}i:85;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:897;}i:86;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:124:"<5>[77037.912449] [(2015-01-20 09:17:43.514659321 UTC)] [cpuid: 2] type=1400 audit(1421745463.509:2172968): avc:  denied  { ";}i:2;i:899;}i:87;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:1;i:1;a:2:{i:0;s:5:"green";i:1;s:0:"";}}i:2;i:1;i:3;s:13:"<color green>";}i:2;i:1023;}i:88;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:3;i:1;s:4:"open";}i:2;i:3;i:3;s:4:"open";}i:2;i:1036;}i:89;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:4;i:1;s:0:"";}i:2;i:4;i:3;s:8:"</color>";}i:2;i:1040;}i:90;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:17:" } for  pid=15871";}i:2;i:1048;}i:91;a:3:{i:0;s:9:"linebreak";i:1;a:0:{}i:2;i:1065;}i:92;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:6:"
comm=";}i:2;i:1067;}i:93;a:3:{i:0;s:18:"doublequoteopening";i:1;a:0:{}i:2;i:1073;}i:94;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:15:"ActivityManager";}i:2;i:1074;}i:95;a:3:{i:0;s:18:"doublequoteclosing";i:1;a:0:{}i:2;i:1089;}i:96;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:6:" name=";}i:2;i:1090;}i:97;a:3:{i:0;s:18:"doublequoteopening";i:1;a:0:{}i:2;i:1096;}i:98;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:4:"stat";}i:2;i:1097;}i:99;a:3:{i:0;s:18:"doublequoteclosing";i:1;a:0:{}i:2;i:1101;}i:100;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:5:" dev=";}i:2;i:1102;}i:101;a:3:{i:0;s:18:"doublequoteopening";i:1;a:0:{}i:2;i:1107;}i:102;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:4:"proc";}i:2;i:1108;}i:103;a:3:{i:0;s:18:"doublequoteclosing";i:1;a:0:{}i:2;i:1112;}i:104;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:23:" ino=5515 scontext=u:r:";}i:2;i:1113;}i:105;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:1;i:1;a:2:{i:0;s:4:"blue";i:1;s:0:"";}}i:2;i:1;i:3;s:12:"<color blue>";}i:2;i:1136;}i:106;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:3;i:1;s:6:"zygote";}i:2;i:3;i:3;s:6:"zygote";}i:2;i:1148;}i:107;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:4;i:1;s:0:"";}i:2;i:4;i:3;s:8:"</color>";}i:2;i:1154;}i:108;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:17:":s0 tcontext=u:r:";}i:2;i:1162;}i:109;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:1;i:1;a:2:{i:0;s:3:"red";i:1;s:0:"";}}i:2;i:1;i:3;s:11:"<color red>";}i:2;i:1179;}i:110;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:3;i:1;s:6:"kernel";}i:2;i:3;i:3;s:6:"kernel";}i:2;i:1190;}i:111;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:4;i:1;s:0:"";}i:2;i:4;i:3;s:8:"</color>";}i:2;i:1196;}i:112;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:11:":s0 tclass=";}i:2;i:1204;}i:113;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:1;i:1;a:2:{i:0;s:7:"fuchsia";i:1;s:0:"";}}i:2;i:1;i:3;s:15:"<color fuchsia>";}i:2;i:1215;}i:114;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:3;i:1;s:4:"file";}i:2;i:3;i:3;s:4:"file";}i:2;i:1230;}i:115;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:4;i:1;s:0:"";}i:2;i:4;i:3;s:8:"</color>";}i:2;i:1234;}i:116;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:1242;}i:117;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:1242;}i:118;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:161:"这种情况可能发生在代码中fork一个进程或者调用system()函数进行read/write某个file时就会出现这些denied，使得操作无法进行。";}i:2;i:1245;}i:119;a:3:{i:0;s:9:"linebreak";i:1;a:0:{}i:2;i:1406;}i:120;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:196:"
那么如何处理这些denied信息，我们拿上面的log作为例子，可以在extern/sepolicy下新建一个test.te文件（这个目录下的te文件会自动全部加入编译），比如";}i:2;i:1408;}i:121;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:1604;}i:122;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:1604;}i:123;a:3:{i:0;s:11:"strong_open";i:1;a:0:{}i:2;i:1606;}i:124;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:7:"test.te";}i:2;i:1608;}i:125;a:3:{i:0;s:12:"strong_close";i:1;a:0:{}i:2;i:1615;}i:126;a:3:{i:0;s:9:"linebreak";i:1;a:0:{}i:2;i:1617;}i:127;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:7:"
allow ";}i:2;i:1619;}i:128;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:1;i:1;a:2:{i:0;s:4:"blue";i:1;s:0:"";}}i:2;i:1;i:3;s:12:"<color blue>";}i:2;i:1626;}i:129;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:3;i:1;s:10:"<scontext>";}i:2;i:3;i:3;s:10:"<scontext>";}i:2;i:1638;}i:130;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:4;i:1;s:0:"";}i:2;i:4;i:3;s:8:"</color>";}i:2;i:1648;}i:131;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:1:" ";}i:2;i:1656;}i:132;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:1;i:1;a:2:{i:0;s:3:"red";i:1;s:0:"";}}i:2;i:1;i:3;s:11:"<color red>";}i:2;i:1657;}i:133;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:3;i:1;s:10:"<tcontext>";}i:2;i:3;i:3;s:10:"<tcontext>";}i:2;i:1668;}i:134;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:4;i:1;s:0:"";}i:2;i:4;i:3;s:8:"</color>";}i:2;i:1678;}i:135;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:1:":";}i:2;i:1686;}i:136;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:1;i:1;a:2:{i:0;s:7:"fuchsia";i:1;s:0:"";}}i:2;i:1;i:3;s:15:"<color fuchsia>";}i:2;i:1687;}i:137;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:3;i:1;s:8:"<tclass>";}i:2;i:3;i:3;s:8:"<tclass>";}i:2;i:1702;}i:138;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:4;i:1;s:0:"";}i:2;i:4;i:3;s:8:"</color>";}i:2;i:1710;}i:139;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:2:"  ";}i:2;i:1718;}i:140;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:1;i:1;a:2:{i:0;s:5:"green";i:1;s:0:"";}}i:2;i:1;i:3;s:13:"<color green>";}i:2;i:1720;}i:141;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:3;i:1;s:11:"<operation>";}i:2;i:3;i:3;s:11:"<operation>";}i:2;i:1733;}i:142;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:4;i:1;s:0:"";}i:2;i:4;i:3;s:8:"</color>";}i:2;i:1744;}i:143;a:3:{i:0;s:9:"linebreak";i:1;a:0:{}i:2;i:1752;}i:144;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:1:"
";}i:2;i:1754;}i:145;a:3:{i:0;s:11:"strong_open";i:1;a:0:{}i:2;i:1755;}i:146;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:9:"1. allow ";}i:2;i:1757;}i:147;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:1;i:1;a:2:{i:0;s:4:"blue";i:1;s:0:"";}}i:2;i:1;i:3;s:12:"<color blue>";}i:2;i:1766;}i:148;a:3:{i:0;s:11:"strong_open";i:1;a:0:{}i:2;i:1778;}i:149;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:6:"zygote";}i:2;i:1780;}i:150;a:3:{i:0;s:12:"strong_close";i:1;a:0:{}i:2;i:1786;}i:151;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:4;i:1;s:0:"";}i:2;i:4;i:3;s:8:"</color>";}i:2;i:1788;}i:152;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:2:"  ";}i:2;i:1796;}i:153;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:1;i:1;a:2:{i:0;s:3:"red";i:1;s:0:"";}}i:2;i:1;i:3;s:11:"<color red>";}i:2;i:1798;}i:154;a:3:{i:0;s:11:"strong_open";i:1;a:0:{}i:2;i:1809;}i:155;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:5:"sysfs";}i:2;i:1811;}i:156;a:3:{i:0;s:12:"strong_close";i:1;a:0:{}i:2;i:1816;}i:157;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:4;i:1;s:0:"";}i:2;i:4;i:3;s:8:"</color>";}i:2;i:1818;}i:158;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:1:":";}i:2;i:1826;}i:159;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:1;i:1;a:2:{i:0;s:7:"fuchsia";i:1;s:0:"";}}i:2;i:1;i:3;s:15:"<color fuchsia>";}i:2;i:1827;}i:160;a:3:{i:0;s:11:"strong_open";i:1;a:0:{}i:2;i:1842;}i:161;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:4:"file";}i:2;i:1844;}i:162;a:3:{i:0;s:12:"strong_close";i:1;a:0:{}i:2;i:1848;}i:163;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:4;i:1;s:0:"";}i:2;i:4;i:3;s:8:"</color>";}i:2;i:1850;}i:164;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:2:"  ";}i:2;i:1858;}i:165;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:1;i:1;a:2:{i:0;s:5:"green";i:1;s:0:"";}}i:2;i:1;i:3;s:13:"<color green>";}i:2;i:1860;}i:166;a:3:{i:0;s:11:"strong_open";i:1;a:0:{}i:2;i:1873;}i:167;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:5:"write";}i:2;i:1875;}i:168;a:3:{i:0;s:12:"strong_close";i:1;a:0:{}i:2;i:1880;}i:169;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:4;i:1;s:0:"";}i:2;i:4;i:3;s:8:"</color>";}i:2;i:1882;}i:170;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:37:"; #解释:允许源上下文类型是";}i:2;i:1890;}i:171;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:1;i:1;a:2:{i:0;s:4:"blue";i:1;s:0:"";}}i:2;i:1;i:3;s:12:"<color blue>";}i:2;i:1927;}i:172;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:3;i:1;s:6:"zygote";}i:2;i:3;i:3;s:6:"zygote";}i:2;i:1939;}i:173;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:4;i:1;s:0:"";}i:2;i:4;i:3;s:8:"</color>";}i:2;i:1945;}i:174;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:36:"的进程对目的上下文类型是";}i:2;i:1953;}i:175;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:1;i:1;a:2:{i:0;s:3:"red";i:1;s:0:"";}}i:2;i:1;i:3;s:11:"<color red>";}i:2;i:1989;}i:176;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:3;i:1;s:5:"sysfs";}i:2;i:3;i:3;s:5:"sysfs";}i:2;i:2000;}i:177;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:4;i:1;s:0:"";}i:2;i:4;i:3;s:8:"</color>";}i:2;i:2005;}i:178;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:3:"的";}i:2;i:2013;}i:179;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:1;i:1;a:2:{i:0;s:7:"fuchsia";i:1;s:0:"";}}i:2;i:1;i:3;s:15:"<color fuchsia>";}i:2;i:2016;}i:180;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:3;i:1;s:4:"file";}i:2;i:3;i:3;s:4:"file";}i:2;i:2031;}i:181;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:4;i:1;s:0:"";}i:2;i:4;i:3;s:8:"</color>";}i:2;i:2035;}i:182;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:6:"进行";}i:2;i:2043;}i:183;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:1;i:1;a:2:{i:0;s:5:"green";i:1;s:0:"";}}i:2;i:1;i:3;s:13:"<color green>";}i:2;i:2049;}i:184;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:3;i:1;s:5:"write";}i:2;i:3;i:3;s:5:"write";}i:2;i:2062;}i:185;a:3:{i:0;s:6:"plugin";i:1;a:4:{i:0;s:5:"color";i:1;a:2:{i:0;i:4;i:1;s:0:"";}i:2;i:4;i:3;s:8:"</color>";}i:2;i:2067;}i:186;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:6:"操作";}i:2;i:2075;}i:187;a:3:{i:0;s:12:"strong_close";i:1;a:0:{}i:2;i:2081;}i:188;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:0:"";}i:2;i:2083;}i:189;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:2089;}i:190;a:3:{i:0;s:4:"code";i:1;a:3:{i:0;s:68:"
2. allow zygote init:file open;

3. allow zygote kernel:file open;
";i:1;N;i:2;N;}i:2;i:2089;}i:191;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:2089;}i:192;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:72:"这样就可以保证上面的log中就不会再出现这些denied了。";}i:2;i:2166;}i:193;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:2238;}i:194;a:3:{i:0;s:13:"section_close";i:1;a:0:{}i:2;i:2240;}i:195;a:3:{i:0;s:6:"header";i:1;a:3:{i:0;s:15:"2. 验证修改";i:1;i:3;i:2;i:2240;}i:2;i:2240;}i:196;a:3:{i:0;s:12:"section_open";i:1;a:1:{i:0;i:3;}i:2;i:2240;}i:197;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:2240;}i:198;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:51:"编译之后，直接查看这个文件就可以。";}i:2;i:2264;}i:199;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:2321;}i:200;a:3:{i:0;s:4:"code";i:1;a:3:{i:0;s:67:"
out/target/product/q39/obj/ETC/sepolicy_intermediates/policy.conf
";i:1;N;i:2;N;}i:2;i:2321;}i:201;a:3:{i:0;s:13:"section_close";i:1;a:0:{}i:2;i:2398;}i:202;a:3:{i:0;s:6:"header";i:1;a:3:{i:0;s:41:"3. 查看进程和文件的sepolicy属性";i:1;i:3;i:2;i:2398;}i:2;i:2398;}i:203;a:3:{i:0;s:12:"section_open";i:1;a:1:{i:0;i:3;}i:2;i:2398;}i:204;a:3:{i:0;s:4:"code";i:1;a:3:{i:0;s:1018:"
shell@TCL_M3G:/ $ ps -Z                                                        
LABEL                          USER     PID   PPID  NAME
u:r:init:s0                    root      1     0     /init
u:r:kernel:s0                  root      2     0     kthreadd
u:r:kernel:s0                  root      3     2     ksoftirqd/0
u:r:kernel:s0                  root      5     2     kworker/0:0H
u:r:kernel:s0                  root      6     2     kworker/u16:0
u:r:kernel:s0                  root      7     2     migration/0

shell@TCL_M3G:/ $ ls -Z
drwxr-xr-x root             root              u:object_r:cgroup:s0 acct
drwxrwx--- system      cache           u:object_r:cache_file:s0 cache
lrwxrwxrwx root           root              u:object_r:rootfs:s0 charger -> /sbin/healthd
dr-x------ root                 root              u:object_r:rootfs:s0 config
lrwxrwxrwx root           root              u:object_r:rootfs:s0 d -> /sys/kernel/debug
drwxrwx--x system      system        u:object_r:system_data_file:s0 data
";i:1;N;i:2;N;}i:2;i:2453;}i:205;a:3:{i:0;s:13:"section_close";i:1;a:0:{}i:2;i:3479;}i:206;a:3:{i:0;s:12:"document_end";i:1;a:0:{}i:2;i:3479;}}