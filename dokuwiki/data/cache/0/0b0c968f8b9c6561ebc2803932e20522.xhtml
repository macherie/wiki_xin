
<p>
1.安装MTK蓝牙demo方法
</p>
<pre class="code"> blink ---&gt; /system/bin/blink  777                //BT协议栈主程序,可命令行运行
 blink_config.ini ----&gt; /system/blink_config.ini  //AT指令,内带说明
 blink_ring.mp3 ----&gt; /system/blink_ring.mp3      //来电铃声问题,可修改.只要名称和路径一样即可.删除不影响蓝牙使用.
 libwapm.so ----&gt; /system/lib/libwapm.so 644      //blink 依赖库
 libblinkdriver.so ----&gt; /system/lib/libwapm.so 644  //blink 依赖库
 adb install BTDemo.apk                           //安装apk 
 </pre>

<p>
2. 先运行blink,再运行apk
</p>

<p>
3.常用命令
</p>
<pre class="code"> adb shell &quot;setenforce 0&quot;          //打开一些权限
 adb shell &quot;blink /dev/ttyMT2&quot;     //运行blink
 adb logcat -s blink               //log
 </pre>

<p>
4.写一个测试小工具
</p>

<p>
添加main.c
</p>
<pre class="code">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;string.h&gt;
#include &lt;android/log.h&gt;
#include &quot;utils/log.h&quot;
#include &lt;termios.h&gt;
#include &lt;time.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/time.h&gt;

int main()
{
	char buf[50];
	int rc;
	int i=0;
	int file_ptr;
	struct termios c_opt;	
	fd_set readfd;
	struct timeval timeout;
	char sendbuf[7]={0x04,0xE4,0x04,0x00,0x00,0x00,0x00};
	char wakebuf = 0x00;
	char startsession[6] = {0x04,0xE4,0x04,0x00,0xFF,0x14};

	file_ptr = open(&quot;/dev/ttyMT2&quot;, O_RDWR | O_NOCTTY | O_NDELAY | O_TRUNC);
	if (-1 == file_ptr) {
		__android_log_print(4, LOG_TAG, &quot;Could not open uart port&quot;);
		return(-1);
	}
	
	if (tcflush(file_ptr, TCIOFLUSH) &lt;0) {
		__android_log_print(4, LOG_TAG, &quot;Could not flush uart port&quot;);
		return(-1);
	}
	
	fcntl(file_ptr, F_SETFL, 0);

	ioctl(file_ptr, TCGETS, &amp;c_opt);

	c_opt.c_cc[VTIME]    = 0;  
	c_opt.c_cc[VMIN]     = 0; 

	c_opt.c_cflag &amp;= ~(CSIZE | CRTSCTS);
        c_opt.c_cflag |= (CS8 | CLOCAL | CREAD);
	c_opt.c_iflag = IGNPAR;
        c_opt.c_oflag = 0;
	c_opt.c_lflag = 0;	
	
	cfsetospeed(&amp;c_opt, B9600);
	cfsetispeed(&amp;c_opt, B9600);
	
	ioctl(file_ptr, TCSETS, &amp;c_opt);

	/*rc = write(file_ptr, buf, 3);
	__android_log_print(4, LOG_TAG, &quot;buf = %x&quot;, buf[0]);
	LOGE(&quot;rc===========%d\n&quot;,rc);*/
	while(1)
	{
		//write(file_ptr,&amp;wakebuf,1);
		memset(buf,0,50);
		usleep(60*1000);
		//write(file_ptr,startsession,7);
		timeout.tv_sec = 1;
		timeout.tv_usec = 0;
		//rc = select(file_ptr+1,&amp;readfd,NULL,NULL,NULL);
		rc = 1;
		if(rc == -1)
		{
			LOGE(&quot;select error\n&quot;);
		}
		else if(rc)
		{
			LOGE(&quot;can read now\n&quot;);
			//if(FD_ISSET(file_ptr,&amp;readfd))
			//{
				rc = read(file_ptr,buf,50);
				//for(i = 0; i &lt; rc;i++)
				LOGE(&quot;----%s----\n&quot;,buf);
			//}

		}
		else if(rc==0)
		{
			LOGE(&quot;select time out\n&quot;);
		}
		sleep(3);
	}

	close(file_ptr);
	__android_log_print(4, LOG_TAG, &quot;irdaWrite end&quot;);
	return 0;
}</pre>

<p>
添加Android.mk
</p>
<pre class="code">LOCAL_PATH := $(call my-dir)

include $(CLEAR_VARS)

LOCAL_SRC_FILES:= main.c

LOCAL_MODULE:= zzz
LOCAL_MODULE_TAGS := optional eng
#LOCAL_C_INCLUDES :=

#LOCAL_STATIC_LIBRARIES :=

#LOCAL_SHARED_LIBRARIES := libcrypto
LOCAL_MODULE_PATH = $(TARGET_OUT)/bin
include $(BUILD_EXECUTABLE)</pre>
