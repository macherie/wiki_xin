
<p>
NSRM 批量应用联网管理
</p>

<p>
现象：
</p>

<p>
1.安装即时通信APP，如腾讯QQ，连接网络后，可以收到推送消息。屏幕熄灭后，等待一段时间后，APP无法立即收到消息，再次点亮屏幕，就会收到新消息通知。
</p>

<p>
2.客户自己开发的定位软件在设备屏幕熄灭后，三到五分钟掉线，无唤醒的话，设备将一直处于离线状态。
</p>

<p>
解决方法：
</p>

<p>
build.prop添加了persist.sys.dpmd.nsrm=1，关闭nsrm
</p>

<p>
解释：
</p>

<p>
Network Socket Request Manager 批量应用联网管理(NSRM)
</p>

<p>
很多用户应用如今都是数据连接的，但这有一个缺点。典型的用户在智能手机上有几十个应用程序，很多是在家里使用，或者每小时都会连一次网，一天连网几次。天气、新闻和社交媒体应用每次同步更新后，很快就会再次断开连接。
</p>

<p>
问题是每个应用的这种连网时间都是相对独立的。这些频繁而又短暂的连接迫使调制解调器从休眠中唤醒，消耗电量。此外，不断连接而又很快中断的信令会堵塞网络，降低网速。
</p>

<p>
NSRM是美国高通技术公司的一个专利功能，能够有效安排和协调这些访问请求，从而减少调制解调器处于连接和工作状态的时间。这些连接请求由软件统一“把守”，；联网更新时间长度可以设置。这段时间过后，或者用户将手机从待机状态唤醒时，“门”就会打开，让这些排成队的应用连接尝试成批访问网络而非让每个应用单独连网。这样可以减少连接请求的次数，减少数据发送，进而减少信令开销。
</p>

<p>
其他：
</p>

<p>
网络连接有以下相关property可供配置
</p>

<p>
persist.dpm.feature: 
</p>

<p>
0 关闭dpm；
</p>

<p>
1 打开fd；
</p>

<p>
4 打开nsrm；
</p>

<p>
persist.sys.dpmd.nsrm 
</p>

<p>
1 关闭nsrm；
</p>

<p>
2 nsrm的1.0版本；
</p>

<p>
3 nsrm的2.0版本；
</p>

<p>
更加详细的关于以上property的内容可常见高通文档80-NU566-1 和 80-NN268-1。
</p>

<p>
由于nsrm的处理流程是闭源的，所以我们在源码当中查找不到任何有关nsrm的代码。
</p>
