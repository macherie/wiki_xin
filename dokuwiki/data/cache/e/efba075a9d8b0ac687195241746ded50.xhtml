
<h1 class="sectionedit1" id="驱动开发规范">驱动开发规范</h1>
<div class="level1">

</div>
<!-- EDIT1 SECTION "驱动开发规范" [1-34] -->
<h2 class="sectionedit2" id="开发规范">开发规范</h2>
<div class="level2">
<ol>
<li class="level1"><div class="li"> 熟练掌握模块所涉及的硬件设计，如所用的电，GPIO，CLOCK等。</div>
</li>
<li class="level1"><div class="li"> 开发阶段时序一定要符合spec。</div>
</li>
<li class="level1"><div class="li"> 关注负责模块的耗电流，包括工作电流，模块加入前后系统底电流变化。</div>
</li>
<li class="level1"><div class="li"> 新功能和较大的修改需要通过评审。</div>
</li>
<li class="level1"><div class="li"> 整体功能完成后需由硬件部配合验证时序。</div>
</li>
<li class="level1"><div class="li"> 对于因为自己代码出现的编译或者运行时的 warning 都需要处理掉。</div>
</li>
<li class="level1"><div class="li"> 主管及时更新项目表格中的模块调试状态。</div>
</li>
</ol>

</div>
<!-- EDIT2 SECTION "开发规范" [35-562] -->
<h2 class="sectionedit3" id="编程规范">编程规范</h2>
<div class="level2">

</div>
<!-- EDIT3 SECTION "编程规范" [563-587] -->
<h3 class="sectionedit4" id="用_if_xxx_endif_的时候需要在_endif_中指名对应的是哪个_if_格式如下_多个_if时">1: 用 #if XXX   #endif  的时候需要在 #endif 中指名对应的是哪个 #if 格式如下：(多个#if时)</h3>
<div class="level3">
<pre class="code c"><span class="kw4">void</span> __init msm8226_add_drivers<span class="br0">&#40;</span><span class="kw4">void</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
<span class="co2">#if NOT_DO_INIT</span>
        msm_smem_init<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        msm_init_modem_notifier_list<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="co2">#if JUST_FOR_TEST</span>
        msm_smd_init<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="co2">#if NOT_USE_RPM_SPM_PM</span>
        msm_rpm_driver_init<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        msm_spm_device_init<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        msm_pm_sleep_status_init<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="co2">#endif /* NOT_USE_RPM_SPM_PM */</span>
<span class="co2">#endif /* JUST_FOR_TEST */</span>
        rpm_regulator_smd_driver_init<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="co2">#endif /* NOT_DO_INIT */</span>
<span class="br0">&#125;</span></pre>

</div>
<!-- EDIT4 SECTION "1: 用 #if XXX   #endif  的时候需要在 #endif 中指名对应的是哪个 #if 格式如下：(多个#if时)" [588-1145] -->
<h3 class="sectionedit5" id="注释掉的代码如果超过两行请使用_if_0_的方式_如果使用_if_0_则需要在后面跟上一个标识_标识后面可以跟上注释_并在对应_endif_中使用此标识">2: 注释掉的代码如果超过两行请使用  #if 0 的方式。如果使用 #if 0 则需要在后面跟上一个标识，标识后面可以跟上注释，并在对应 #endif 中使用此标识：</h3>
<div class="level3">
<pre class="code c"><span class="kw4">void</span> __init msm8226_add_drivers<span class="br0">&#40;</span><span class="kw4">void</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
        msm_smem_init<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        msm_init_modem_notifier_list<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        msm_smd_init<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="co2">#if 0 //TEST_LABEL: 注释</span>
        msm_rpm_driver_init<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        msm_spm_device_init<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        msm_pm_sleep_status_init<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        rpm_regulator_smd_driver_init<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        qpnp_regulator_init<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="kw1">if</span> <span class="br0">&#40;</span>of_board_is_rumi<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
                msm_clock_init<span class="br0">&#40;</span><span class="sy0">&amp;</span>msm8226_rumi_clock_init_data<span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="kw1">else</span>
                msm_clock_init<span class="br0">&#40;</span><span class="sy0">&amp;</span>msm8226_clock_init_data<span class="br0">&#41;</span><span class="sy0">;</span>
        tsens_tm_init_driver<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="co2">#endif /* TEST_LABEL */</span>
        msm_thermal_device_init<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

</div>
<!-- EDIT5 SECTION "2: 注释掉的代码如果超过两行请使用  #if 0 的方式。如果使用 #if 0 则需要在后面跟上一个标识，标识后面可以跟上注释，并在对应 #endif 中使用此标识：" [1146-1957] -->
<h3 class="sectionedit6" id="缩进格式保持和源文件一致_如果是新建文件_缩进使用4个空格">3:缩进格式保持和源文件一致，如果是新建文件， 缩进使用4个空格</h3>
<div class="level3">

</div>
<!-- EDIT6 SECTION "3:缩进格式保持和源文件一致，如果是新建文件， 缩进使用4个空格" [1958-2057] -->
<h3 class="sectionedit7" id="对于不能一眼就看出来的功能或者算法_需要写注释说明功能或者原理等_自己写的代码文件要有说明">4:对于不能一眼就看出来的功能或者算法，需要写注释说明功能或者原理等。自己写的代码文件要有说明</h3>
<div class="level3">

</div>
<!-- EDIT7 SECTION "4:对于不能一眼就看出来的功能或者算法，需要写注释说明功能或者原理等。自己写的代码文件要有说明" [2058-2206] -->
<h3 class="sectionedit8" id="对于自己定义的对外接口函数需要对其说明_包括功能_参数_返回值_格式如下">5:对于自己定义的对外接口函数需要对其说明，包括功能，参数，返回值，格式如下：</h3>
<div class="level3">
<pre class="code c"><span class="coMULTI">/*************************************************
 * Description: 函数功能、性能等的描述
 * Input: 输入参数说明，包括每个参数的作用、取值说明及参数间关系。
 * Return: 函数返回值的说明
**************************************************/</span></pre>

</div>
<!-- EDIT8 SECTION "5:对于自己定义的对外接口函数需要对其说明，包括功能，参数，返回值，格式如下：" [2207-2632] -->
<h3 class="sectionedit9" id="对于数据结构申明_需要在成员后面注明功能等">6:对于数据结构申明，需要在成员后面注明功能等</h3>
<div class="level3">

</div>
<!-- EDIT9 SECTION "6:对于数据结构申明，需要在成员后面注明功能等" [2633-2709] -->
<h3 class="sectionedit10" id="注释的格式要统一起来_simt-姓名-年月日_姓请采用首字母_名字请使用拼音全称_不采用英文命名规则_采用顺序拼写_比如_周靓炯">7:注释的格式要统一起来，[SIMT-姓名-年月日]，姓请采用首字母，名字请使用拼音全称，不采用英文命名规则，采用顺序拼写,比如“周靓炯”</h3>
<div class="level3">

<p>
注释示例：
</p>
<pre class="code c"><span class="br0">&#91;</span>SIMT<span class="sy0">-</span>zliangjiong<span class="sy0">-</span><span class="nu0">20140101</span><span class="br0">&#93;</span></pre>

</div>
<!-- EDIT10 SECTION "7:注释的格式要统一起来，[SIMT-姓名-年月日]，姓请采用首字母，名字请使用拼音全称，不采用英文命名规则，采用顺序拼写,比如“周靓炯”" [2710-2968] -->
<h3 class="sectionedit11" id="单行代码也需要用_比如">8:单行代码也需要用{},比如：</h3>
<div class="level3">
<pre class="code c"><span class="kw1">if</span><span class="br0">&#40;</span>ret <span class="sy0">&lt;</span> <span class="nu0">0</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    <span class="kw1">return</span> ret<span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

</div>
<!-- EDIT11 SECTION "8:单行代码也需要用{},比如：" [2969-3067] -->
<h3 class="sectionedit12" id="命名要有意义_review人员需要在codereview或者代码评审的时候去关注">9:命名要有意义，Review人员需要在codereview或者代码评审的时候去关注</h3>
<div class="level3">

</div>
<!-- EDIT12 SECTION "9:命名要有意义，Review人员需要在codereview或者代码评审的时候去关注" [3068-3169] -->
<h3 class="sectionedit13" id="代码行最大长度宜控制在70至80个字符以内">10:代码行最大长度宜控制在70至80个字符以内</h3>
<div class="level3">

<p>
长表达式要在低优先级操作符处拆分成新行，操作符放在新行之首（以便突出操作符），拆分出的新行要进行适当的缩进，使排版整齐，语句可读
</p>
<pre class="code c"><span class="kw1">if</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>very_longer_variable1 <span class="sy0">&gt;=</span> very_longer_variable12<span class="br0">&#41;</span>
    <span class="sy0">&amp;&amp;</span> <span class="br0">&#40;</span>very_longer_variable3 <span class="sy0">&lt;=</span> very_longer_variable14<span class="br0">&#41;</span>
    <span class="sy0">&amp;&amp;</span> <span class="br0">&#40;</span>very_longer_variable5 <span class="sy0">&lt;=</span> very_longer_variable16<span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    DoSomething<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

</div>
<!-- EDIT13 SECTION "10:代码行最大长度宜控制在70至80个字符以内" [3170-3641] -->
<h3 class="sectionedit14" id="使用统一的debug打印函数_规范打印信息_在user版本中把debug信息关闭">11:使用统一的Debug打印函数，规范打印信息，在user版本中把debug信息关闭</h3>
<div class="level3">

</div>
<!-- EDIT14 SECTION "11:使用统一的Debug打印函数，规范打印信息，在user版本中把debug信息关闭" [3642-3748] -->
<h3 class="sectionedit15" id="代码里要做输入验证边界检查_不要让别人犯的错导致我们的程序崩溃_code_review人员在review时需要关注">12:代码里要做输入验证边界检查，不要让别人犯的错导致我们的程序崩溃(Code Review人员在review时需要关注)</h3>
<div class="level3">

</div>
<!-- EDIT15 SECTION "12:代码里要做输入验证边界检查，不要让别人犯的错导致我们的程序崩溃(Code Review人员在review时需要关注)" [3749-3899] -->
<h3 class="sectionedit16" id="降低函数间的耦合度_并提高函数的独立性以及代码可读性_效率和可维护性_code_review人员在review时需要关注">13:降低函数间的耦合度，并提高函数的独立性以及代码可读性、效率和可维护性(Code Review人员在review时需要关注)</h3>
<div class="level3">

<p>
<a href="/dokuwiki/lib/exe/fetch.php/%E8%A7%84%E8%8C%83;%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83-v1.0.pdf" class="media mediafile mf_pdf" title="规范:驱动开发规范-v1.0.pdf (122.9 KB)">驱动开发规范-v1.0.pdf</a>
</p>

</div>
<!-- EDIT16 SECTION "13:降低函数间的耦合度，并提高函数的独立性以及代码可读性、效率和可维护性(Code Review人员在review时需要关注)" [3900-] -->