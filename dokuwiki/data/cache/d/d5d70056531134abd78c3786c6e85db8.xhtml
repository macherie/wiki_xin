
<p>
— <em><a href="mailto:&#x73;&#x68;&#x75;&#x2e;&#x79;&#x69;&#x6e;&#x40;&#x73;&#x69;&#x6d;&#x2e;&#x63;&#x6f;&#x6d;" class="mail" title="&#x73;&#x68;&#x75;&#x2e;&#x79;&#x69;&#x6e;&#x40;&#x73;&#x69;&#x6d;&#x2e;&#x63;&#x6f;&#x6d;">尹姝</a> 2014/2/21</em>
</p>

<h1 class="sectionedit1" id="智能设备扫描头接口说明">智能设备扫描头接口说明</h1>
<div class="level1">
<div class="table sectionedit2"><table class="inline">
	<tr class="row0">
		<th class="col0 leftalign">Document Title:     </th><td class="col1">SIMCom智能设备扫描头接口说明</td>
	</tr>
	<tr class="row1">
		<th class="col0 leftalign">Version:            </th><td class="col1 leftalign">1.01                    </td>
	</tr>
	<tr class="row2">
		<th class="col0 leftalign">Date:               </th><td class="col1 leftalign">2014-02-13              </td>
	</tr>
	<tr class="row3">
		<th class="col0 leftalign">Status:             </th><td class="col1 leftalign">Release                 </td>
	</tr>
	<tr class="row4">
		<th class="col0">Document Control ID:</th><td class="col1 leftalign">SIM0005                 </td>
	</tr>
	<tr class="row5">
		<th class="col0 leftalign">Writer:             </th><td class="col1 leftalign">Yunqi.miao              </td>
	</tr>
</table></div>
<!-- EDIT2 TABLE [94-403] --><hr />

</div>
<!-- EDIT1 SECTION "智能设备扫描头接口说明" [46-412] -->
<h2 class="sectionedit3" id="通过程序代码开启扫描">通过程序代码开启扫描</h2>
<div class="level2">

<p>
通过广播实现，广播名称为：<span style='color:cadetblue; '>android.intent.action.SIMSCAN</span>
</p>

<p>
<span style='color:forestgreen; '>举例：</span>
</p>
<pre class="code java">context.<span class="me1">sendBroadcast</span><span class="br0">&#40;</span><span class="kw1">new</span> Intent<span class="br0">&#40;</span><span class="st0">&quot;android.intent.action.SIMSCAN&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
<span style='color:forestgreen; '>说明：</span>
</p>

<p>
在通过程序广播开启扫描时，扫描灯持续时间最长为6秒，即扫描头的激光灯将在6秒后自动关闭。
</p>

</div>
<!-- EDIT3 SECTION "通过程序代码开启扫描" [413-842] -->
<h2 class="sectionedit4" id="通过程序代码关闭扫描">通过程序代码关闭扫描</h2>
<div class="level2">

<p>
通过广播实现，广播名称为：<span style='color:cadetblue; '>android.intent.action.SIMSCAN</span>
</p>

<p>
<span style='color:forestgreen; '>举例：</span>
</p>
<pre class="code java">context.<span class="me1">sendBroadcast</span><span class="br0">&#40;</span><span class="kw1">new</span> Intent<span class="br0">&#40;</span><span class="st0">&quot;android.intent.action.SIMSCAN&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
<span style='color:forestgreen; '>说明：</span>
</p>

<p>
在通过程序广播开启扫描时，扫描灯持续时间最长为6秒，即扫描头的激光灯将在6秒后自动关闭，那么在6秒时间内，可以通过如上的广播来关闭扫描头。
</p>

</div>
<!-- EDIT4 SECTION "通过程序代码关闭扫描" [843-1345] -->
<h2 class="sectionedit5" id="通过程序代码获取扫描结果">通过程序代码获取扫描结果</h2>
<div class="level2">

<p>
通过广播实现，广播名称为：<span style='color:cadetblue; '>com.sim.action.SIMSCAN</span>，广播参数为：<span style='color:cadetblue; '>value</span>，参数类型为：<span style='color:cadetblue; '>String</span>
</p>

<p>
<span style='color:forestgreen; '>举例：</span>
</p>
<pre class="code java">    @Override
    <span class="kw1">protected</span> <span class="kw4">void</span> onCreate<span class="br0">&#40;</span>Bundle savedInstanceState<span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw1">super</span>.<span class="me1">onCreate</span><span class="br0">&#40;</span>savedInstanceState<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
        <span class="co1">////////////////</span>
        mReceiver <span class="sy0">=</span> <span class="kw1">new</span> BroadcastReceiver<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            @Override
            <span class="kw1">public</span> <span class="kw4">void</span> onReceive<span class="br0">&#40;</span><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+context"><span class="kw3">Context</span></a> context, Intent intent<span class="br0">&#41;</span> <span class="br0">&#123;</span>
                <span class="co1">//让其它的广播注册者无法获取广播信息，***此处必须***</span>
                <span class="kw1">this</span>.<span class="me1">abortBroadcast</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
                <span class="co1">//此处获取扫描结果信息</span>
                <span class="kw1">final</span> <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+string"><span class="kw3">String</span></a> scanResult <span class="sy0">=</span> intent.<span class="me1">getStringExtra</span><span class="br0">&#40;</span><span class="st0">&quot;value&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
                mTvScanResult.<span class="me1">setText</span><span class="br0">&#40;</span>scanResult<span class="br0">&#41;</span><span class="sy0">;</span>
                mTvScanResult.<span class="me1">invalidate</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="br0">&#125;</span>
        <span class="br0">&#125;</span><span class="sy0">;</span>
&nbsp;
        mFilter <span class="sy0">=</span> <span class="kw1">new</span> IntentFilter<span class="br0">&#40;</span><span class="st0">&quot;com.sim.action.SIMSCAN&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="co1">//在用户自行获取数据时，将广播的优先级调到最高 1000，***此处必须***</span>
        mFilter.<span class="me1">setPriority</span><span class="br0">&#40;</span>IntentFilter.<span class="me1">SYSTEM_HIGH_PRIORITY</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="co1">////////////////</span>
    <span class="br0">&#125;</span>
&nbsp;
    @Override
    <span class="kw1">protected</span> <span class="kw4">void</span> onResume<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw1">super</span>.<span class="me1">onResume</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
        <span class="co1">//注册广播来获取扫描结果</span>
        <span class="kw1">this</span>.<span class="me1">registerReceiver</span><span class="br0">&#40;</span>mReceiver, mFilter<span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
&nbsp;
    @Override
    <span class="kw1">protected</span> <span class="kw4">void</span> onPause<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="co1">//注销获取扫描结果的广播</span>
        <span class="kw1">this</span>.<span class="me1">unregisterReceiver</span><span class="br0">&#40;</span>mReceiver<span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="kw1">super</span>.<span class="me1">onPause</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span></pre>

<p>
<span style='color:forestgreen; '>说明：</span>
在获取扫描结果时，需要重点关注的是
</p>

<p>
1）在程序捕获到广播时，需要执行：
</p>
<pre class="code java"><span class="kw1">this</span>.<span class="me1">abortBroadcast</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
2）需要将广播接收优先级调至最高：
</p>
<pre class="code java">mFilter.<span class="me1">setPriority</span><span class="br0">&#40;</span>IntentFilter.<span class="me1">SYSTEM_HIGH_PRIORITY</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

</div>
<!-- EDIT5 SECTION "通过程序代码获取扫描结果" [1346-] -->