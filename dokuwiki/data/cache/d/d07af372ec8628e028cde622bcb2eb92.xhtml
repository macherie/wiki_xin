
<h2 class="sectionedit1" id="由于imei导致不能识别sim卡">由于IMEI导致不能识别SIM卡</h2>
<div class="level2">

<p>
客户返回了一台S55的机器，机器不能识别SIM卡,不知道客户具体做过些什么（无卡的显示无卡的标致，有卡的时候显示一个三角，CIT测试无法通过）.
</p>

</div>
<!-- EDIT1 SECTION "由于IMEI导致不能识别SIM卡" [1-241] -->
<h2 class="sectionedit2" id="分析过程">分析过程:</h2>
<div class="level2">

<p>
1，由于当时比较忙，所以把机器给了硬件，硬件测试了SIM卡的相关信号确认没有问题，需要软件继续分析
</p>

<p>
2，给高通提了个case，要了一份如下的logmask来抓取log：
</p>

<p>
<a href="/dokuwiki/lib/exe/fetch.php/linux;892x;s55;uim.rar" class="media mediafile mf_rar" title="linux:892x:s55:uim.rar (11.5 KB)">uim.rar</a>
</p>

<p>
3, 由于需要抓开机的log,所以要求做以下设置，把SIM初始化往后推迟，否则抓取不到需要的log.
</p>

<p>
#Delay 10s
</p>

<p>
Please set NV4205 uim_config_params.future_use[57] to 10
</p>

<p>
Please collect qxdm log using attached log mask from power on to us for check
</p>

<p>
4, 按照高通的需求抓取QXDM log：
</p>

<p>
<a href="/dokuwiki/lib/exe/fetch.php/linux;892x;s55;20140815_uim_log.rar" class="media mediafile mf_rar" title="linux:892x:s55:20140815_uim_log.rar (255.4 KB)">20140815_uim_log.rar</a>
</p>

<p>
5, 高通分析出来得到的结论如下：
</p>

<p>
From this log, PERSO check fail because IMEI is not set or improperly set 
</p>

<p>
Fail reason:IMEI is not set or improperly set. 
</p>

<p>
Please set NV550(IMEI) to a valid value and test this. 
</p>

<p>
MSG [00021/03] User Identity Module/Error 22:03:20.857 mmgsdi_perso_engine.c 01459 MMGSDI: PERSO: IMEI is not set or improperly set 
</p>

<p>
MSG [00021/03] User Identity Module/Error 22:03:20.857 mmgsdi_perso_engine.c 01881 MMGSDI: PERSO: PERSO ENGINE Get IMEI Failure: 0x3 
</p>

<p>
MSG [00021/03] User Identity Module/Error 22:03:20.857 mmgsdi_perso_engine.c 03933 PERSO: UMTS Personalization failed 0x3 
</p>

<p>
MSG [00021/03] User Identity Module/Error 22:03:20.857 mmgsdi_perso_engine.c 04049 MMGSDI: PERSO: Could not get all feature indicators: 0x3 
</p>

<p>
MSG [00021/03] User Identity Module/Error 22:03:20.857 mmgsdi_perso_engine.c 04897 PERSO: Could not get all the locks 
</p>

<p>
MSG [00021/02] User Identity Module/High 22:03:20.861 mmgsdi.c 07985 MMGSDI_CARD_ERROR/REMOVED_EVT, condition: 0x16, slot: 0x1
</p>

<p>
6，把出问题的机器用QXDM连上之后发现，NV550被激活，但是所有的值为0,所以导致机器不能识别SIM卡，用QXDM写入一个正常的IMEI之后机器就能正常找到SIM卡了。
</p>

</div>
<!-- EDIT2 SECTION "分析过程:" [242-2089] -->
<h2 class="sectionedit3" id="结论">结论:</h2>
<div class="level2">

<p>
跟骁飞确认，系统开机会读取NV550的值，如果是没有被激活，采用代码里默认的IMEI值，如果被激活，系统就采用NV的值，如果NV
</p>

<p>
里面的值没有或者不符合规范，系统就会报错，从而导致不能识别SIM卡。
</p>

</div>
<!-- EDIT3 SECTION "结论:" [2090-] -->